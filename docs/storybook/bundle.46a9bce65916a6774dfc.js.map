{"version":3,"file":"bundle.46a9bce65916a6774dfc.js","mappings":"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","sources":["webpack://phaser-webpack-template/./storybook/StoryScene.ts","webpack://phaser-webpack-template/./storybook/interfaces.ts","webpack://phaser-webpack-template/./src/components/Test/TestButton.ts","webpack://phaser-webpack-template/./src/components/Test/TestButton.story.ts","webpack://phaser-webpack-template/./storybook/stories.ts","webpack://phaser-webpack-template/./src/scenes/MainScene.ts","webpack://phaser-webpack-template/./src/config.ts","webpack://phaser-webpack-template/./storybook/index.ts"],"sourcesContent":["export class StoryScene extends Phaser.Scene {\n  preload() {\n    /** включает в себя загрузку текстуры поэтому ставим тут **/\n    // addTestMapBg(this).catch(console.warn);\n  }\n  create() {\n    console.log(\"Story Scene created...\");\n  }\n}\n","export type GameObject =\n  | Phaser.GameObjects.Container\n  | Phaser.GameObjects.Image\n  | Phaser.GameObjects.Text\n  | Phaser.GameObjects.RenderTexture\n  | Phaser.GameObjects.Shape\n  | Phaser.GameObjects.TileSprite;\n\nexport interface IStory {\n  title: string;\n  /**\n   *  run\n   *  - может создавать что угодно на сцене\n   *  - возвращаемая функция должна очищать созданный объект\n   *  - добавление к сцене лежит на его ответственности\n   */\n  run: (scene: Phaser.Scene) => Promise<() => void>;\n}\n\nexport interface IStoryListItem extends Partial<IStory>{\n  title: string;\n  template?: 'titleDelimiter',\n  run?: (scene: Phaser.Scene) => Promise<() => void>;\n}\n\nexport const storyTitle = (title:string):IStoryListItem=>({ title, template: 'titleDelimiter'})\n","interface IProps {\n  scene: Phaser.Scene;\n  text: string;\n}\n\nexport class TestButton extends Phaser.GameObjects.Container {\n  constructor({ scene, text }: IProps) {\n    super(scene);\n    const textObject = scene.add.text(0, 0, text, { fontSize: \"32px\", color: \"#dedede\" });\n\n    this.add([textObject]);\n    scene.add.existing(this as Phaser.GameObjects.Container);\n  }\n}\n","import { IStory } from \"../../../storybook/interfaces\";\nimport { TestButton } from \"./TestButton\";\n\nexport const testButtonStory: IStory = {\n  title: \"TestButton\",\n  run: async (scene) => {\n    const container = new TestButton({ scene, text: \"Hello\" });\n\n    return ()=>{\n      container.destroy();\n    }\n  }\n};\n\nexport const testButtonStory2: IStory = {\n  title: \"TestButton 2\",\n  run: async (scene) => {\n    const container = new TestButton({ scene, text: \"Hello2\" });\n\n    return ()=>{\n      container.destroy();\n    }\n  }\n};\n","import { IStoryListItem, storyTitle } from \"./interfaces\";\nimport { testButtonStory, testButtonStory2 } from \"../src/components/Test/TestButton.story\";\n\nexport const stories: IStoryListItem[] = Array.from(\n  new Set<IStoryListItem>([\n    storyTitle(\"Simple Games\"),\n    testButtonStory,\n    testButtonStory2\n  ])\n);\n","export class MainScene extends Phaser.Scene {\n  constructor() {\n    super(MainScene.name);\n  }\n\n  preload() {\n    this.load.image(\"sky\", \"./assets/images/space3.png\");\n    this.load.image(\"logo\", \"./assets/images/phaser3-logo.png\");\n    this.load.image(\"red\", \"./assets/images/red.png\");\n  }\n\n  create() {\n    this.add.image(400, 300, \"sky\");\n\n    const particles = this.add.particles(0, 0, \"red\", {\n      speed: 100,\n      scale: { start: 1, end: 0 },\n      blendMode: \"ADD\"\n    });\n\n    const logo = this.physics.add.image(400, 100, \"logo\");\n\n    logo.setVelocity(100, 200);\n    logo.setBounce(1, 1);\n    logo.setCollideWorldBounds(true);\n\n    particles.startFollow(logo);\n\n    console.log('Game started');\n  }\n}\n","import { MainScene } from \"./scenes/MainScene\";\n\nconst scaleConfig: Phaser.Types.Core.ScaleConfig = {\n  mode: Phaser.Scale.FIT,\n  autoCenter: Phaser.Scale.CENTER_BOTH,\n  parent: \"game\",\n  width: 960,\n  height: 640\n};\n\nexport interface IPhaserConfig extends Phaser.Types.Core.GameConfig {\n  scale: Phaser.Types.Core.ScaleConfig;\n}\n\nexport const phaserGameConfig: IPhaserConfig = {\n  width: 800,\n  height: 600,\n  physics: {\n    default: \"arcade\",\n    arcade: {\n      gravity: { x: 0, y: 200 }\n    }\n  },\n  type: Phaser.AUTO,\n  backgroundColor: \"#4488aa\",\n  transparent: true,\n  scale: scaleConfig,\n  scene: [MainScene]\n};\n","import { StoryScene } from \"./StoryScene\";\nimport { stories } from \"./stories\";\nimport { IStory, IStoryListItem } from \"./interfaces\";\nimport { IPhaserConfig, phaserGameConfig } from \"../src/config\";\n\n\nconst config: IPhaserConfig = {\n  ...phaserGameConfig,\n  scale: {\n    ...phaserGameConfig.scale,\n    mode: Phaser.Scale.NONE,\n    autoCenter: Phaser.Scale.NONE,\n  },\n  scene: [new StoryScene(StoryScene.name)],\n};\n\nconst game = new Phaser.Game(config);\n\nconst storiesEl = document.getElementById(\"stories\");\nif (storiesEl == null) throw \"no sidebar\";\nconst titleEl = document.getElementById(\"gameTitle\");\n\nlet prevStoryClose: () => void | undefined;\nconst runInGame = async (story: IStory, game: Phaser.Game) => {\n  prevStoryClose?.();\n  titleEl!.innerHTML = story.title;\n  const scene = game.scene.getScene(StoryScene.name);\n  prevStoryClose = await story.run(scene);\n};\n\nlet storiesIndex = 0;\nstories.forEach((story) => {\n  if (story.run != null) {\n    addStory(story as IStory, storiesEl, storiesIndex == 0);\n    storiesIndex++;\n  } else if (story.template === \"titleDelimiter\") {\n    addStoryDelimiter(story, storiesEl);\n  }\n});\n\nfunction addStory(story: IStory, storiesEl: HTMLElement, isStart: boolean) {\n  const el = addElement({\n    storyTag: \"button\",\n    innerHtml: `${story.title}`,\n    className: \"story\",\n    parent: storiesEl,\n  });\n  el.addEventListener(\"click\", () => runInGame(story, game).catch(console.warn));\n\n  if (isStart) {\n    setTimeout(() => {\n      el.focus();\n      runInGame(story, game).catch(console.warn);\n    }, 500);\n  }\n}\n\nfunction addStoryDelimiter(story: IStoryListItem, storiesEl: HTMLElement) {\n  return addElement({\n    storyTag: \"div\",\n    innerHtml: `${story.title}`,\n    className: \"storyDelimiter\",\n    parent: storiesEl,\n  });\n}\n\ninterface IAddProps {\n  storyTag: string;\n  innerHtml: string;\n  className: string;\n  parent: HTMLElement;\n}\nfunction addElement({ storyTag, className, innerHtml, parent }: IAddProps) {\n  const el = document.createElement(storyTag);\n  el.innerHTML = innerHtml;\n  el.classList.add(className);\n  parent.append(el);\n  return el;\n}\n"],"names":["StoryScene","storyTitle","title","TestButton","scene","text","textObject","testButtonStory","container","testButtonStory2","stories","MainScene","particles","logo","scaleConfig","phaserGameConfig","config","game","storiesEl","titleEl","prevStoryClose","runInGame","story","storiesIndex","addStory","addStoryDelimiter","isStart","el","addElement","storyTag","className","innerHtml","parent"],"sourceRoot":""}